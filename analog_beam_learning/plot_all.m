clear
close all

%%

load('H_fc.mat')

plot_pattern(channel_fc, 'k')

learned_phase = [-0.78540,1.57080,-1.57080,-0.78540,1.57080,2.35619,0.78540,0.78540,2.35619,-2.35619,-0.78540,0.00000,-2.35619,-1.57080,0.00000,0.00000,-2.35619,-1.57080,-1.57080,-1.57080,-0.78540,0.00000,2.35619,2.35619,2.35619,-0.78540,2.35619,-2.35619,-1.57080,-0.78540,0.78540,2.35619,3.14159,-2.35619,-2.35619,0.00000,-2.35619,-1.57080,-1.57080,-0.78540,1.57080,-1.57080,0.78540,0.00000,3.14159,-2.35619,1.57080,1.57080,-2.35619,3.14159,-1.57080,1.57080,1.57080,2.35619,0.00000,1.57080,-0.78540,-0.78540,0.78540,3.14159,0.00000,2.35619,2.35619,-1.57080,0.00000,0.78540,2.35619,-2.35619,2.35619,-2.35619,-1.57080,1.57080,3.14159,-1.57080,0.78540,1.57080,-0.78540,0.78540,3.14159,3.14159,2.35619,2.35619,-2.35619,0.00000,1.57080,1.57080,-1.57080,-1.57080,-1.57080,0.00000,-2.35619,-2.35619,0.00000,-2.35619,0.00000,0.78540,1.57080,2.35619,-2.35619,-1.57080,-0.78540,2.35619,-2.35619,-0.78540,0.00000,0.78540,-1.57080,0.00000,0.00000,0.78540,-2.35619,-0.78540,2.35619,-2.35619,-2.35619,-1.57080,0.78540,0.78540,-2.35619,0.00000,0.78540,2.35619,3.14159,-2.35619,0.00000,-1.57080,0.78540,0.78540,-0.78540,-2.35619,1.57080,3.14159,-0.78540,0.78540,1.57080,0.00000,0.78540,1.57080,2.35619,-0.78540,2.35619,-2.35619,-1.57080,-0.78540,2.35619,2.35619,3.14159,-1.57080,0.00000,2.35619,3.14159,-0.78540,0.78540,1.57080,3.14159,-1.57080,-0.78540,-0.78540,-2.35619,-0.78540,-0.78540,0.78540,1.57080,1.57080,-0.78540,-0.78540,0.78540,0.78540,3.14159,-2.35619,-1.57080,1.57080,2.35619,3.14159,-0.78540,0.00000,1.57080,-2.35619,-2.35619,-0.78540,0.00000,0.00000,0.00000,0.00000,-2.35619,-2.35619,0.00000,2.35619,-0.78540,0.00000,-2.35619,-0.78540,0.78540,1.57080,2.35619,0.00000,0.78540,0.78540,2.35619,2.35619,2.35619,3.14159,-2.35619,-0.78540,-0.78540,1.57080,0.00000,0.00000,0.78540,-2.35619,-1.57080,-1.57080,0.00000,2.35619,-1.57080,0.00000,-2.35619,-2.35619,-2.35619,0.78540,2.35619,-2.35619,-2.35619,-0.78540,-0.78540,0.78540,0.78540,0.78540,-2.35619,0.78540,-1.57080,-0.78540,-0.78540,1.57080,-2.35619,-0.78540,1.57080,3.14159,-0.78540,0.00000,2.35619,-0.78540,3.14159,-2.35619,1.57080,-0.78540,0.00000,0.00000,0.78540,2.35619,2.35619,-0.78540,0.00000,0.78540,2.35619,-2.35619];
learned_beam = 1/sqrt(length(learned_phase)) * exp(1j * learned_phase.');

hold on
plot_pattern(learned_beam, 'b')
